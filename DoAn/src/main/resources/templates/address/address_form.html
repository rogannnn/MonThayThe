<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="vi">
<head th:replace="~{fragments/main_fragment.html::page_head('New address')}"/>
<body>
<div class="container-fluid">
    <nav th:replace="~{fragments/main_fragment.html :: navbar}"></nav>
    <div class="m-4">
        <h3 th:if="${address.id == null}">Thêm mới địa chỉ</h3>
        <h3 th:unless="${address.id  == null}">Cập nhật địa chỉ</h3>
    </div>
    <form th:action="@{/address/save}" method="post" style="max-width: 700px; margin: 0 auto"
          enctype="multipart/form-data" id="addressForm"
          th:object="${address}" class="mb-3">
        <input type="hidden" th:field="*{id}" id="addressId"/>
        <div class="border border-secondary rounded p-3">

            <div class="form-group row">
                <label class="col-sm-3 col-form-label">Full name:</label>
                <div class="col-sm-9">
                 <input type="text" class="form-control" id="name"  th:field="*{name}" required minlength="2"
                       maxlength="128"/>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">Phone number:</label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" id="phone" th:field="*{phone}" required minlength="10"
                           maxlength="20"/>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-3 col-form-label">Specific address:</label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" id="specificAddress" th:field="*{specificAddress}" required minlength="6"
                           maxlength="45" />
                </div>
            </div>
                <div class="form-group row">
                    <label class="col-sm-3 col-form-label">Province</label>
                    <div class="col-sm-9">
                        <select id="inputProvince" class="form-control">
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-3 col-form-label">District</label>
                    <div class="col-sm-9">
                        <select id="inputDistrict" class="form-control">>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-3 col-form-label">Ward</label>
                    <div class="col-sm-9">
                        <select id="inputWard" class="form-control" th:field="*{ward}">
                        </select>
                    </div>
                </div>
            <div th:if="${address.id != null}" style="display: none">
                <input type="checkbox" th:checked="${address.default}" th:field="*{default}">
            </div>
            <div th:if="${address.id == null}"
                    class="form-group row">
                <label class="col-sm-3 col-form-label">Địa chỉ mặc định</label>
                <div class="col-sm-9 d-flex align-items-center">
                    <input class="form-check-input" type="checkbox" th:field="*{default}"/>
                </div>
            </div>
            <div class="text-center pt-3">
                <input type="submit" value="Lưu" class="btn btn-primary">
                <input type="button" value="Cancel" class="btn btn-secondary" id="buttonCancelAddresss">
            </div>
        </div>

    </form>

</div>
<div th:replace="~{modals/modal.html :: modal}"></div>
<!--footer-->
<footer th:replace="~{fragments/main_fragment.html:: footer}"></footer>
<script>
    let contextPath = "[[@{/}]]";
    let addressId = "[[${address.id}]]";
    let wardCode = "[[${wardCode}]]";
    let districtCode = "[[${districtCode}]]";
    let provinceCode = "[[${provinceCode}]]";

    $("#addressForm").submit(function(event) {
        // Kiểm tra giá trị của phần tử select
        var selectedWard = $("#inputWard").val();

        if (!selectedWard) {
            event.preventDefault(); // Ngăn chặn việc submit form
            alert("Vui lòng chọn đầy đủ địa chỉ trước khi submit!");
        }
    });

    moduleURL = "[[@{/address}]]";

    $("#buttonCancelAddresss").on("click", function () {
        window.location = moduleURL;
    });




        // if(!name){
        //     Swal.fire({
        //         title: '',
        //         text: MESSAGE_NOTIFY.LASTNAME_BLANK_ERROR,
        //         icon: 'error',
        //         confirmButtonColor: '#3085d6',
        //         timer : 3000,
        //         timerProgressBar: true
        //     })
        //     return;
        // }
        //
        // if(!phone){
        //     Swal.fire({
        //         title: '',
        //         text: MESSAGE_NOTIFY.PHONE_BLANK_ERROR,
        //         icon: 'error',
        //         confirmButtonColor: '#3085d6',
        //         timer : 3000,
        //         timerProgressBar: true
        //     })
        //     return;
        // }
        // let vietnamPhoneRegex = /^(0|\+84)[1-9]\d{8,9}$/;
        // if (!vietnamPhoneRegex.test(phone)) {
        //     Swal.fire({
        //         title: '',
        //         text: MESSAGE_NOTIFY.PHONE_VALIDATE_ERROR,
        //         icon: 'error',
        //         confirmButtonColor: '#3085d6',
        //         timer : 3000,
        //         timerProgressBar: true
        //     })
        //     return;
        // }
        //
        // if(!specificAddress){
        //     Swal.fire({
        //         title: '',
        //         text: MESSAGE_NOTIFY.SPECIFIC_ADDRESS_BLANK_ERROR,
        //         icon: 'error',
        //         confirmButtonColor: '#3085d6',
        //         timer : 3000,
        //         timerProgressBar: true
        //     })
        //     return;
        // }
        // if (!selectedWard) {
        //     Swal.fire({
        //         title: '',
        //         text: MESSAGE_NOTIFY.FULL_ADDRESS_ERROR,
        //         icon: 'error',
        //         confirmButtonColor: '#3085d6',
        //         timer : 3000,
        //         timerProgressBar: true
        //     })
        // }
        //
        // $.ajax({
        //     url: '/address/save',
        //     method: 'POST',
        //     data:{
        //         id: addressId,
        //         name: name,
        //         phone: phone,
        //         specificAddress: specificAddress,
        //         isDefault: isDefault,
        //         wardCode :
        //     }
        // })
    // });



</script>
<script type="text/javascript" th:src="@{/js/address.js}"></script>
<script type="text/javascript" th:src="@{/js/show_dropdown_user.js}"></script>
<script type="text/javascript" th:src="@{/js/NOTIFY.js}"></script>
<script type="text/javascript" th:src="@{/js/common.js}"></script>
</body>
</html>